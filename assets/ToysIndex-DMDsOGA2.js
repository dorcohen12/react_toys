import{r as c,j as e,s as d,S as b,c as v,d as p,R as T,L as h,e as E,f as g,g as k,O as w,h as F,i as B}from"./index-4DJCFm8d.js";import{t as f}from"./toy.service-DZCfPixY.js";import"./robot.service-CcKsjWgf.js";function R(t,n){const s=c.useRef(!0);c.useEffect(()=>{if(s.current){s.current=!1;return}t()},n)}function N({filterBy:t,onSetFilterBy:n}){console.log("Filter Render!");const[s,i]=c.useState(t);c.useEffect(()=>{n(s)},[s]);function r({target:u}){let{name:x,value:a,type:o}=u;switch(o){case"number":case"range":a=+a;break;case"checkbox":a=u.checked}i(j=>({...j,[x]:a}))}const{name:l,inStock:y,labels:m}=s;return e.jsxs("form",{className:"toy-filter",children:[e.jsx("h1",{children:"Filter"}),e.jsxs("section",{children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{value:l,name:"name",id:"name",onChange:r})]}),e.jsxs("section",{children:[e.jsx("label",{htmlFor:"inStock",children:"In Stock"}),e.jsxs("select",{name:"inStock",id:"inStock=",onChange:r,children:[e.jsx("option",{value:"all",checked:!0,children:"All"}),e.jsx("option",{value:1,children:"In Stock"}),e.jsx("option",{value:0,children:"Out of Stock"})]})]}),e.jsx("section",{children:e.jsx("button",{children:"Submit"})})]})}function O(t){const[n,s]=c.useState(t);function i(r){s(typeof r=="boolean"?r:l=>!l)}return[n,i]}async function P(){try{const t=d.getState().robotModule.filterBy,n=await f.query(t);d.dispatch({type:v,toys:n})}catch(t){throw console.log("Having issues with loading robots:",t),p("Having issues with loading robots:"),t}}async function L(t){try{await f.remove(t),d.dispatch({type:T,toyId:t})}catch(n){throw console.log("Having issues removing toy:",n),n}}function S(t){d.dispatch({type:b,filterBy:t})}function M({toy:t}){return e.jsxs("article",{className:"toy-preview",children:[e.jsx("h2",{children:t.name}),e.jsxs("h4",{children:["Price: ",t.price," ILS"]}),e.jsx(h,{to:`/toy/${t._id}`,children:e.jsx("button",{className:"btn-primary",children:"View Details"})})]})}function _({toys:t,onRemoveToy:n}){return e.jsx("ul",{className:"toy-list",children:t.map(s=>e.jsxs("li",{children:[e.jsx(M,{toy:s}),e.jsxs("section",{className:"toy-actions",children:[e.jsx("button",{onClick:()=>n(s._id),children:"X"}),e.jsx(h,{style:{color:"white"},to:`/toys/edit/${s._id}`,children:"Edit"})]})]},s._id))})}function $(){const[t,n]=E(),s=g(o=>o.toyModule.toys),i=g(o=>o.toyModule.filterBy),r=c.useRef(k(y,400)).current;O(!1),c.useEffect(()=>{S(f.getFilterFromSearchParams(t))},[]),R(()=>{P(),n(F(i))},[i]);async function l(o){try{await L(o),B("Robot removed successfully!")}catch{p(`Having issues removing robot (${o})`)}}function y(o){S(o)}if(!s)return e.jsx("div",{children:"Loading..."});const{name:m,inStock:u,type:x,labels:a}=i;return e.jsxs("section",{className:"toy-index",children:[e.jsx("h1",{children:"Welcome! this is our toys"}),e.jsx(N,{onSetFilterBy:r,filterBy:{name:m,inStock:u,labels:a}}),e.jsx(h,{to:"/toys/edit",children:"Add Toy"}),e.jsx(_,{toys:s,onRemoveToy:l}),e.jsx(w,{})]})}export{$ as default};
